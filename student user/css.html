<!DOCTYPE html>
<html lang="en">
<head>
    <title>Anti duplicate software</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.8.335/pdf.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.27.0/ace.js"></script>
    <link rel="stylesheet" href="userpanel.css">   
    <link rel="database" href="database.js">

</head>
<body>
    <nav>
       
        <div class="Pname">
            <img class="logo" id="loo" src="light1.png">
        <div class="menu">
            <span class="feat"><a class="no" href="userpanel.html">Home</a></span>
            <span class="feat"><a class="no" href="../plagi">Search</a></span>
            <span class="feat"><a class="Active" href="one-to-one.html">one-to-one</a></span>
            <span class="feat"><a class="no" href="self detect.html">self detect</a></span>
            <span class="feat"><a class="no" href="code plagi.html">code</a></span>
            <span class="feat"><a class="no" href="../plagiarism">All plagi</a></span>
            <span class="feat"><a class="no" href="userupload.html">File upload</a></span>
                
            <!--<span class="feat"><a class="no" href="http://localhost:3000/">File upload</a></span>-->
            <div class="logout">
                <div class="table1">
                    <div class="profile-dropdown">
                        <a href="profile.html">
                            <div class="img"><div id="image-container1">profile</div></div>
                        </a>
                        <div class="dropdown-menu">
                            <ul>
                                <li><a href="#"><img id="dark" src="suns.png"></a></li>
                                <li><span ><a href="profile.html"  class="set" ><i class="fas fa-cog"></i>setting</a></li></span>
                                <li><span class="fe" ><a id="logout-btn" class="noo">log out</a>
                                </span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
    </nav><br><br><br><br><br>
    <div id="logout-popup" class="popup1">
        <h2>Logout Confirmation</h2>
        <p>Are you sure you want to logout?</p>
        <button href="/logout" id="logout-yes">Yes</button>
        <button id="logout-no">No</button>
      </div>
    <div class="content">
        <div class="type">
            <a class="ty" href="one-to-one.html">HTML</a>
            <span class="ty"><a class="Acc" href="css.html">CSS</a></span>
            <a class="ty" href="js.html">JS</a>
    </div>
        <h1>One-To-One <br> Plagiarize two codes with each other</h1>
        
        <div class="upload-btn-wrapper">
            <button class="btn">Upload a file</button>
            <input type="file" class="put" id="file1" onchange="updateEditorFromFile(this, ace.edit('editor'))">
        </div>
        
        <div class="upload-btn-wrapper1">
            <button class="btn1">Upload a file</button>
            <input type="file" class="put1" id="file2" onchange="updateEditorFromFile(this, ace.edit('editor1'))">
        </div>
                <div class="editor-container">
            <div id="editor">// testing 1</div>
            <div id="editor1">// testing 1</div>
        </div>
    
    
        <div class="check">
            <button id="check" onclick="checkPlagiarism()">Check Plagiarism</button>
        </div>
        <div class="res">
            <div class="ResPec">
            <h2 id="result">Plagiarism</h2>
        </div>
        <div id="copied-lines" style="display: none;">
            <h3>similar Lines:</h3>
           <ul id="copied-lines-list"></ul>
        </div> 

        <div id="not-similar-lines" style="display: none;">
            <h3>Not Similar Lines:</h3>
            <ul id="not-similar-lines-list"></ul>
        </div>
    </div>
    
        <!-- Popup for the message -->
        
        <div id="popup" class="popup">
            <p id="popupMessage"></p>
            <button onclick="closePopup()">OK</button>
        </div>
    
    
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="footer-col">
                    <h4 class="About">About</h4>
                    <ul>
                        <li><a href="#">company</a></li>
                        <li><a href="#">our services</a></li>
                        <li><a href="#">privacy policy</a></li>
                        <li><a href="#">affiliate program</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="About">BLOG</h4>
                    <ul>
                        <li><a href="#">Plagiarism</a></li>
                        <li><a href="#">detection</a></li>
                        <li><a href="#">Request for project</a></li>
                        <li><a href="#">status</a></li>
                        <li><a href="#">repeated code</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="About">contact</h4>
                    <ul>
                        <li><a href="#">3698521470</a></li>
                        <li><a href="#">Anti_Duplicate_32111@gmail.in</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="About">follow us</h4>
                    <div class="social-links">
                        <a class="face" href="https://www.facebook.com/"><img  src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Facebook_icon.svg/640px-Facebook_icon.svg.png"></a>
                        <a href="https://www.snapchat.com/add/yashsaundalkar?share_id=cYg_jUWXxA4&locale=en-IN"><img src="data:image/png;base64,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"></a>
                        <a class="insta" href="https://www.instagram.com/yash.kappa300/"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Instagram_logo_2022.svg/1200px-Instagram_logo_2022.svg.png"></i></a>
                        
                    </div>
                   
                </div>
            </div>
        </div>
       
   </footer>
</div>
<script>
    function saveImage() {
        const input = document.getElementById('image-input');
        const file = input.files[0];
        
        // Check if username exists in cookies
        const username = getCookie('username');
        if (!username) {
            alert("Please enter your username first.");
            return;
        }
        
        if (file) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const imageData = event.target.result;
                // Store image data along with username in local storage
                localStorage.setItem(username + '_savedImage', imageData);
                displayImageInMultipleContainers(imageData);
            };
            reader.readAsDataURL(file);
        }
    }
    
    function displayImageInMultipleContainers(imageData) {
        // Get both image containers by their IDs
        const container1 = document.getElementById('image-container1');
        const container2 = document.getElementById('image-container2');
        
        // Set the inner HTML of both containers to display the image
        container1.innerHTML = `<img src="${imageData}" alt="Saved Image">`;
        container2.innerHTML = `<img src="${imageData}" alt="Saved Image">`;
    }
    
    // Load the image from localStorage when the page loads
    window.onload = function() {
        // Check if username exists in cookies
        const username = getCookie('username');
        if (!username) {
            const usernamePrompt = prompt("Please enter your username:");
            if (usernamePrompt) {
                document.cookie = `username=${usernamePrompt}`;
            }
        }
        
        const savedImageData = localStorage.getItem(username + '_savedImage');
        if (savedImageData) {
            displayImageInMultipleContainers(savedImageData);
        }
    };
    
    // Function to get the value of a cookie by its name
    function getCookie(name) {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.startsWith(name + '=')) {
                return cookie.substring(name.length + 1);
            }
        }
        return null;
    }
    
        document.getElementById('logout-btn').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('logout-popup').style.display = 'block';
    });
    
    document.getElementById('logout-no').addEventListener('click', function() {
        document.getElementById('logout-popup').style.display = 'none';
    });
    
    document.getElementById('logout-yes').addEventListener('click', function() {
        // Handle logout here
        document.getElementById('logout-popup').style.display = 'none';
        window.location.href = '/logout';
    });
    
    
    function getCookie(name) {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.startsWith(name + '=')) {
                return cookie.substring(name.length + 1);
            }
        }
        return null;
    }
</script>
    <script>
        const darkModePreference = localStorage.getItem('darkMode');
const dark = document.getElementById("dark");
const loo = document.getElementById("loo");

if (darkModePreference === 'enabled') {
    document.body.classList.add('dark-theme');
    dark.src = "moons.png"; // Set the image to sun.png in dark mode
    loo.src = "dark1.png";
} else {
    dark.src = "suns.png"; // Set the image to moon.png in light mode
    loo.src = "light1.png";
}

dark.onclick = function () {
    document.body.classList.toggle("dark-theme");

    if (document.body.classList.contains("dark-theme")) {
        localStorage.setItem('darkMode', 'enabled');
        dark.src = "moons.png";
        loo.src = "dark1.png";
    } else {
        localStorage.setItem('darkMode', 'disabled');
        dark.src = "suns.png";
        loo.src = "light1.png";
    }
}


function showPopupMessage(message) {
    const popupMessage = document.getElementById('popupMessage');
    popupMessage.textContent = message;
    const popup = document.getElementById('popup');
    popup.style.display = 'block';

    // Add an event listener to the OK button
    const popupOKButton = document.getElementById('popupOKButton');
    popupOKButton.addEventListener('click', () => {
        // Hide the popup when the OK button is clicked
        popup.style.display = 'none';
    });
}
function showPopupMessage(message) {
    const popupMessage = document.getElementById('popupMessage');
    popupMessage.textContent = message;
    const popup = document.getElementById('popup');
    popup.style.display = 'block';

    // Add an event listener to the OK button
    const popupOKButton = document.getElementById('popupOKButton');
    popupOKButton.addEventListener('click', () => {
        // Hide the popup when the OK button is clicked
        popup.style.display = 'none';
    });
}

document.addEventListener("DOMContentLoaded", function() {
    const editor1 = ace.edit("editor1");
    editor1.setTheme("ace/theme/cobalt");
    editor1.getSession().setMode("ace/mode/css");
    
    const editor2 = ace.edit("editor");
    editor2.setTheme("ace/theme/cobalt");
    editor2.getSession().setMode("ace/mode/css");
});


// ... (your existing functions) ...


// Event listeners for file input fields
document.getElementById('file1').addEventListener('change', function () {
    updateEditorFromFile(this, ace.edit("editor"));
});

document.getElementById('file2').addEventListener('change', function () {
    updateEditorFromFile(this, ace.edit("editor1"));
});
// Function to get the Ace editor line number
function getAceEditorLineNumber(editor, lineNumber) {
    return lineNumber - 1; // Adjust for Ace editor's 0-based index
}
document.getElementById('checkPlagiarism').addEventListener('click', function() {
    checkPlagiarism();
});

function checkPlagiarism() {
    // Get the content of both editors
    const editor1 = ace.edit("editor");
    const editor2 = ace.edit("editor1");
    const code1 = editor1.getValue();
    const code2 = editor2.getValue();

    // Check if either editor is empty
    if (!code1.trim() || !code2.trim()) {
        displayPopup('Please input code in both editors.');
        // Clear any previously displayed copied lines and not similar lines
        clearCopiedLines();
        clearNotSimilarLines();
        return; // Exit the function
    }

    // Function to split code into lines and filter out empty lines
    const getCleanLines = (code) => code.split('\n').map(line => line.trim()).filter(line => line.length > 0);

    // Get cleaned lines
    const cleanLines1 = getCleanLines(code1);
    const cleanLines2 = getCleanLines(code2);

    // Check if both code snippets are empty after removing empty lines
    if (cleanLines1.length === 0 || cleanLines2.length === 0) {
        displayPopup('No code found.');
        // Clear any previously displayed copied lines and not similar lines
        clearCopiedLines();
        clearNotSimilarLines();
        return; // Exit the function
    }

    // Check for HTML/JavaScript in the CSS editor
    if (containsHTMLorJS(cleanLines1)) {
        displayPopup('Error: The CSS editor should only contain CSS code.');
        // Clear any previously displayed copied lines and not similar lines
        clearCopiedLines();
        clearNotSimilarLines();
        return; // Exit the function
    }

    // Check for HTML/JavaScript in the CSS editor
    if (containsHTMLorJS(cleanLines2)) {
        displayPopup('Error: The CSS editor should only contain CSS code.');
        // Clear any previously displayed copied lines and not similar lines
        clearCopiedLines();
        clearNotSimilarLines();
        return; // Exit the function
    }

    // Find common lines between the two code snippets
    const commonLines = getCommonLines(cleanLines1, cleanLines2);

    // Check if there are common lines
    if (commonLines.length === 0) {
        displayPopup('No similarities found.');
        // Clear any previously displayed copied lines and not similar lines
        clearCopiedLines();
        clearNotSimilarLines();
        return; // Exit the function
    }

    // Calculate plagiarism percentage
    const plagiarismPercentage = (commonLines.length / Math.max(cleanLines1.length, cleanLines2.length)) * 100;

    // Display the result, ensuring the percentage is capped at 100%
    const resultElement = document.getElementById('result');
    resultElement.textContent = `Plagiarism Percentage: ${Math.min(plagiarismPercentage, 100).toFixed(2)}%`;

    // Find not similar lines
    const notSimilarLines1 = cleanLines1.filter(line1 => !cleanLines2.includes(line1));
    const notSimilarLines2 = cleanLines2.filter(line2 => !cleanLines1.includes(line2));

    // Display copied lines (optional)
    displayCopiedLines(commonLines);

    // Display not similar lines
    displayNotSimilarLines(notSimilarLines1, notSimilarLines2);

    function containsHTMLorJS(lines) {
        const htmlJSRegex = /<[^>]+>|<\/[^>]+>|<script[^>]*>[\s\S]*?<\/script>/i;
        return lines.some(line => htmlJSRegex.test(line));
    }
}

// ... (rest of the functions remain unchanged)



// Function to find common lines between two arrays

function getCommonLines(array1, array2) {
    const common = [];

    const minLength = Math.min(array1.length, array2.length);

    for (let i = 0; i < minLength; i++) {
        const line1 = array1[i];
        const line2 = array2[i];

        if (line1 === line2) {
            common.push({ editor1Line: i + 1, editor2Line: i + 1, text: line1 });
        } else {
            // If lines don't match, continue checking remaining lines in longer snippet
            for (let j = i + 1; j < array1.length; j++) {
                if (array1[j] === array2[i]) {
                    // Found a matching line in the longer snippet
                    common.push({ editor1Line: j + 1, editor2Line: i + 1, text: array1[j] });
                    break;
                }
            }
            for (let k = i + 1; k < array2.length; k++) {
                if (array2[k] === array1[i]) {
                    // Found a matching line in the longer snippet
                    common.push({ editor1Line: i + 1, editor2Line: k + 1, text: array2[k] });
                    break;
                }
            }
        }
    }

    return common;
}
// Function to display copied lines
function displayCopiedLines(commonLines) {
    const copiedLinesList = document.getElementById('copied-lines-list');
    copiedLinesList.innerHTML = '';

    commonLines.forEach(line => {
        const listItem = document.createElement('li');
        listItem.textContent = `Editor line ${line.editor1Line} = Editor1 line ${line.editor2Line}: ${line.text}`;
        copiedLinesList.appendChild(listItem);
    });

    // Show the copied lines div
    const copiedLinesDiv = document.getElementById('copied-lines');
    copiedLinesDiv.style.display = 'block';
}

// Function to clear copied lines
function clearCopiedLines() {
    const copiedLinesList = document.getElementById('copied-lines-list');
    copiedLinesList.innerHTML = '';

    // Hide the copied lines div
    const copiedLinesDiv = document.getElementById('copied-lines');
    copiedLinesDiv.style.display = 'none';
}

// Function to display not similar lines
function displayNotSimilarLines(lines1, lines2) {
    const notSimilarLinesList = document.getElementById('not-similar-lines-list');
    notSimilarLinesList.innerHTML = '';

    lines1.forEach(line => {
        const listItem = document.createElement('li');
        listItem.textContent = `Not Similar (Editor 1): ${line}`;
        notSimilarLinesList.appendChild(listItem);
    });

    lines2.forEach(line => {
        const listItem = document.createElement('li');
        listItem.textContent = `Not Similar (Editor 2): ${line}`;
        notSimilarLinesList.appendChild(listItem);
    });

    // Show the not similar lines div
    const notSimilarLinesDiv = document.getElementById('not-similar-lines');
    notSimilarLinesDiv.style.display = 'block';
}

// Function to clear not similar lines
function clearNotSimilarLines() {
    const notSimilarLinesList = document.getElementById('not-similar-lines-list');
    notSimilarLinesList.innerHTML = '';

    // Hide the not similar lines div
    const notSimilarLinesDiv = document.getElementById('not-similar-lines');
    notSimilarLinesDiv.style.display = 'none';
}


// Function to display popup messages
function displayPopup(message) {
    const popup = document.getElementById('popup');
    const popupMessage = document.getElementById('popupMessage');
    popupMessage.textContent = message;
    popup.style.display = 'block';

    // Add an event listener to the OK button
    const okButton = document.querySelector('#popup button');
    okButton.addEventListener('click', () => {
        // Hide the popup when the OK button is clicked
        popup.style.display = 'none';
    });
}

var referrer = document.referrer;

// Check if the referrer is from the "student user" directory
if (referrer.includes("/student user/")) {
    // If the referrer is from "student user," block the back button
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
        history.go(1);
    };
}


const ejs = require('ejs');

app.set('view engine', 'ejs');
app.set('views', __dirname + '/views');


function cancelFileSelection() {
    var fileInput = document.getElementById("fileInput");
    fileInput.value = ""; // Clear the file input
    var fileWrapper = document.getElementById("filewrapper");
    fileWrapper.innerHTML = ""; // Clear the file list
}




function saveImage() {
    const input = document.getElementById('image-input');
    const file = input.files[0];
    
    if (file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        const imageData = event.target.result;
        localStorage.setItem('savedImage', imageData);
        displayImage(imageData);
      };
      reader.readAsDataURL(file);
    }
  }

  function displayImage(imageData) {
    const container = document.getElementById('image-container');
    container.innerHTML = `<img src="${imageData}" alt="Saved Image">`;
  }

  // Load the image from localStorage when the page loads
  window.onload = function() {
    const savedImageData = localStorage.getItem('savedImage');
    if (savedImageData) {
      displayImage(savedImageData);
    }
  };
    </script>
</body>
</html>